---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

---
title: "centraldogma"
output: rmarkdown::pdf_document
vignette: >
  %\VignetteIndexEntry{centraldogma}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE}
library(centraldogma)
library(ggplot2)
library(stringr)
options(device = function() ragg::agg_png())
```

## Overview

The **centraldogma** package enables you to simulate and process DNA sequences into RNA, codons, and amino acids, ending with a barplot of amino acid counts. This vignette demonstrates the five functions in the package.

### Step 1: Generate a DNA Sequence

We start by generating a random DNA sequence of a specified length. Here, `generate_sequence()` takes a single parameter, `sequence_length`, and returns a random DNA sequence.

```{r}
# Generate a random DNA sequence
sequence_length <- 100
dna_sequence <- generate_sequence(sequence_length)
dna_sequence
```

### Step 2: Transcription - Converting DNA to RNA

The `transcription()` function converts the DNA sequence to an RNA sequence by replacing thymine (T) with uracil (U).

```{r}
# Transcribe the DNA sequence to RNA
rna_sequence <- transcription(dna_sequence)
rna_sequence
```

### Step 3: Convert RNA to Codons

The `RNA_to_codon()` function splits the RNA sequence into codons (groups of three nucleotides). By default, the function starts at the first position.

```{r}
# Convert RNA sequence to codons
codons <- RNA_to_codon(rna_sequence)
codons
```

### Step 4: Translate Codons to Amino Acids

With `aa_sequence()`, the codons are translated into their corresponding amino acids. This function requires a predefined **codon table** named `codon_table` that maps each codon to an amino acid.

```{r}
# Translate codons to amino acid sequence
amino_acid_sequence <- aa_sequence(codons)
amino_acid_sequence
```

### Step 5: Visualize Amino Acid Counts

Finally, `colplot_number_aa_in_protseq()` takes the amino acid sequence and generates a barplot of amino acid counts.

```{r}
# Plot amino acid counts
colplot_number_aa_in_protseq(amino_acid_sequence)
```
